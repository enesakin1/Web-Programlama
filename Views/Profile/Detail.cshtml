@using Microsoft.AspNetCore.Identity
@model myiotprojects.Models.ProfileModel
@inject UserManager<myiotprojects.Areas.Identity.Data.AppUser> UserManager


<div class="container border-bottom bg-white mt-1 pt-md-3 pt-2">
    <div class="d-flex flex-md-row justify-content-around align-items-center">
        <div class="d-flex flex-md-row align-items-center">
            <div class="p-md-2"> <img src="@Model.ProfileImageUrl" alt="" class="rounded-circle" id="profile"> </div>
            <div class="p-md-2 p-1" id="info">
                <h5>@Model.UserName</h5>
                <div class="text-muted">Member Since @Model.ProfileCreated.ToString("MMMM dd, yyyy")</div>
            </div>
        </div>
        <div class="d-flex flex-column" id="info">
            <div class="p-md-1 text-muted"> <span class="fa fa-envelope-o bg-light p-1 rounded-circle"></span> @Model.Email</div>
        </div>
    </div>
    <div class="pl-lg-5 pt-lg-2 pt-md-1">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation"> <a href="#user" class="nav-link active" id="user-tab" data-toggle="tab" data role="tab" aria-controls="user" aria-selected="true">User Profile</a> </li>
            <li class="nav-item" role="presentation"> <a href="#settings" class="nav-link text-muted" id="settings-tab" data-toggle="tab" role="tab" aria-controls="settings" aria-selected="false">Settings</a> </li>
        </ul>
    </div>
</div>
<div class="tab-content w-100 pt-md-0">
    <div class="tab-pane show active" id="user" role="tabpanel" aria-labelledby="user-tab">
        <div class="container rounded-bottom bg-light">
            <div class="row pl-lg-5 pt-md-0 pt-sm-2">
                <div class="col-md-6 py-md-4">
                    <h3>Last 10 posts</h3>
                    <br />
                    @if (Model.AllPosts.Any())
                    {
                        <table class="table table-hover table-bordered">
                            <tbody>
                                @foreach (var post in Model.AllPosts)
                                {
                                    <tr>
                                        <td>
                                            <div>
                                                <a class="searchTitle" asp-controller="Post" asp-action="Index" asp-route-id="@post.Id">@post.Title</a>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="forumPostCount">
                                                Replies: @post.Replies.Count()
                                            </div>
                                        </td>
                                        <td>
                                            <div class="postDate">
                                                @post.Created
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <div class="noPosts">
                            <h3>
                                There is no post this user created <br />
                            </h3>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
    <div class="tab-pane show" id="settings" role="tabpanel" aria-labelledby="settings-tab">
        <div class="container rounded-bottom bg-light">
            <div class="row">
                <div class="col-sm-12">
                    <h1>Change Password</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-sm-offset-3">
                    <p class="text-center">Use the form below to change your password.</p>
                    <form asp-controller="Profile" asp-action="ChangePassword" method="post">
                        <input asp-for="ChangePasswordModel.OldPassword" class="input-lg form-control" placeholder="Old Password">
                        <input asp-for="ChangePasswordModel.NewPassword" class="input-lg form-control" placeholder="New Password">
                        <input asp-for="ChangePasswordModel.ConfirmPassword" class="input-lg form-control" placeholder="Repeat Password" autocomplete="off">
                        <div class="row">
                            <div class="col-sm-12">
                                <span asp-validation-for="ChangePasswordModel" class="glyphicon glyphicon-remove text-warning"></span>
                            </div>
                        </div>
                        <input type="submit" class="col-xs-12 btn btn-primary btn-load btn-lg" data-loading-text="Changing Password..." value="Change Password">
                    </form>
                </div><!--/col-sm-6-->
            </div><!--/row-->
        </div>
    </div>
</div>